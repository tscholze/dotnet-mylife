@page "/"
@using MyLife.Blazor.Wasm.Components
@using MyLife.Blazor.Wasm.Components.CV
@using MyLife.Blazor.Wasm.Extensions
@using MyLife.Core.Generator
@using MyLife.Core.Models
@inject HttpClient Http

<PageTitle>Home</PageTitle>

<header style="margin-bottom: 12px;">
    @((MarkupString)headerText)
    <hr />
</header>

<content>
    <Avatar Persona="@life.Persona" />
    <CurriculumVitae Data="@life.CurriculumVitae" />
</content>

<footer>
    <hr />
    @((MarkupString)footerText)
</footer>

@code {
    private Life life = SampleGenerators.GenerateLife();
    private string headerText = string.Empty;
    private string footerText = string.Empty;

    #region Init

    protected override void OnInitialized()
    {
        base.OnInitialized();

        headerText = MakeHeaderText();
        footerText = MakeFooterText();
    }

    #endregion

    #region UI builder

    private string MakeHeaderText()
    {
        var headerText = life.Persona.GetFullname();

        var nickname = life.Persona.Nicknames.First();
        if (nickname != null)
        {
            headerText += " | " + nickname;
        }

        return headerText;
    }

    private string MakeFooterText()
    {
        var footerText = $"Made with ❤️ | .NET | Blazor | {life.Persona.GetFullname()}";

        var icons = life.SocialMedia.Select(p => p.GetIconLinkElement());
        footerText += " | " + string.Join("  ", icons);

        return footerText;
    }

    #endregion
}